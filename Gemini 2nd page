<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Scoring Tool</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Define CSS Variables for easy theme management */
        :root {
            --primary-color: #2E7D32; /* Darker green for better contrast */
            --primary-light: #4CAF50; /* Lighter green for accents */
            --secondary-color: #1565C0; /* Darker blue for better contrast */
            --secondary-light: #2196F3; /* Lighter blue for accents */
            --background-light: #f8fafc; /* Very light background */
            --background-dark: #e8edf2; /* Slightly darker background for math section */
            --text-color: #2d3748; /* Darker grey for better readability */
            --text-light: #4a5568; /* Lighter text */
            --border-color: #e2e8f0; /* Very light grey for borders */
            --shadow-light: rgba(0, 0, 0, 0.05); /* Very light shadow */
            --shadow-medium: rgba(0, 0, 0, 0.1); /* Medium shadow */
            --error-color: #D32F2F; /* Darker red for better contrast */
            --success-color: #388E3C; /* Darker green for better contrast */
            --warning-color: #F57C00; /* Darker amber for better contrast */
            --card-radius: 12px; /* Consistent border radius */
            --transition: all 0.2s ease-in-out; /* Smooth transitions */
        }

        /* Basic Body Styling */
        body {
            font-family: 'Roboto', sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 0;
            background: var(--background-light);
            color: var(--text-color);
            line-height: 1.5;
            box-sizing: border-box;
        }

        /* Main container for content */
        .container {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: 0 4px 20px var(--shadow-light);
            overflow: hidden;
            margin-bottom: 20px;
        }

        /* Header styling */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px 30px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .header h1 {
            margin: 0;
            font-size: 2.2rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .header p {
            margin: 10px 0 0;
            font-weight: 300;
            opacity: 0.9;
            font-size: 1rem;
        }

        /* Main content area */
        .content {
            padding: 25px 30px;
        }

        /* Input section */
        .input-section {
            display: flex;
            gap: 30px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .input-column {
            flex: 1;
            min-width: 250px;
        }

        .metrics-column {
            flex: 2;
            min-width: 300px;
        }

        /* Form Input Group Styling */
        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
            font-size: 0.95rem;
        }

        .input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .input-wrapper i {
            position: absolute;
            left: 12px;
            color: var(--text-light);
            font-size: 0.9rem;
        }

        input[type="text"],
        input[type="number"],
        select { /* Added select for dropdowns */
            width: 100%;
            padding: 12px 15px 12px 35px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 0.95rem;
            box-sizing: border-box;
            transition: var(--transition);
            background: var(--background-light);
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus { /* Added select for dropdowns */
            border-color: var(--secondary-light);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
            outline: none;
        }
        
        /* Button Styling */
        button {
            background-color: var(--primary-color);
            color: white;
            padding: 14px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            width: 100%;
            margin-top: 10px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        button:hover {
            background-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.2);
        }

        button:active {
            transform: translateY(0);
        }

        /* Results Grid Layout */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        /* Styling for all output sections */
        .output {
            background: white;
            padding: 20px;
            border-radius: var(--card-radius);
            box-shadow: 0 2px 10px var(--shadow-light);
            font-size: 0.95rem;
            border-top: 4px solid var(--primary-light);
            transition: var(--transition);
        }

        .output:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px var(--shadow-medium);
        }

        /* Specific colors for scenario outputs */
        .output.pessimistic {
            border-top-color: var(--error-color);
        }

        .output.optimistic {
            border-top-color: var(--success-color);
        }

        /* Strong text within output sections */
        .output strong {
            color: var(--secondary-color);
            font-weight: 600;
        }
        .output.pessimistic strong {
            color: var(--error-color);
        }
        .output.optimistic strong {
            color: var(--success-color);
        }

        /* Heading within output sections */
        .output h3 {
            font-size: 1.1rem;
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--text-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Math Section Styling */
        .math {
            font-family: 'Roboto Mono', monospace;
            background: var(--background-dark);
            white-space: pre-wrap;
            font-size: 0.85rem;
            border-left: none;
            margin-top: 30px;
            padding: 20px;
            border-radius: var(--card-radius);
            box-shadow: 0 2px 10px var(--shadow-light);
            overflow-x: auto;
        }

        /* Metrics Section Styling */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px var(--shadow-light);
            text-align: center;
            transition: var(--transition);
        }

        .metric-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px var(--shadow-medium);
        }

        .metric-card h4 {
            margin: 0 0 8px;
            font-size: 0.85rem;
            color: var(--text-light);
            font-weight: 500;
        }

        .metric-card p {
            margin: 0;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-color);
        }

        /* Recommendation Widget Styling */
        .recommendation-widget {
            margin-top: 30px;
            padding: 20px;
            background: white;
            border-radius: var(--card-radius);
            box-shadow: 0 2px 10px var(--shadow-light);
            text-align: center;
        }

        .recommendation-widget h2 {
            color: var(--secondary-color);
            margin-bottom: 15px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        /* Finnhub widget container */
        .finnhub-widget-container {
            height: 200px;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 2px 8px var(--shadow-light);
        }

        /* Value highlight */
        .value-highlight {
            font-size: 1.4rem;
            font-weight: 700;
            margin: 10px 0;
            padding: 8px 0;
            border-radius: 6px;
        }

        .positive {
            color: var(--success-color);
            background-color: rgba(56, 142, 60, 0.1);
        }

        .negative {
            color: var(--error-color);
            background-color: rgba(211, 47, 47, 0.1);
        }

        /* Tooltip styling */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
            margin-left: 5px;
        }

        .tooltip i {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--text-color);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            font-weight: 400;
            line-height: 1.4;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Table styling for the scoring section */
        .scoring-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
            border-radius: var(--card-radius);
            overflow: hidden; /* Ensures rounded corners apply to content */
            box-shadow: 0 2px 10px var(--shadow-light);
        }

        .scoring-table th, .scoring-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .scoring-table thead th {
            background-color: var(--secondary-color);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .scoring-table tbody tr:nth-child(even) {
            background-color: var(--background-dark);
        }

        .scoring-table tbody tr:hover {
            background-color: var(--background-dark);
            transition: background-color 0.2s ease-in-out;
        }

        .scoring-table td select {
            padding: 8px 10px;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            background-color: white;
            appearance: none; /* Remove default arrow */
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%232d3748%22%20d%3D%22M287%2069.9a17.9%2017.9%200%200%200-25.5%200L146.2%20185.1%2031%2069.9A17.9%2017.9%200%200%200%205.5%2095.4l119.7%20119.7c7%207%2017.9%207%2025%200L287%2095.4A17.9%2017.9%200%200%200%20287%2069.9z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 12px;
            cursor: pointer;
        }

        .score-total {
            background-color: var(--primary-color);
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            padding: 15px;
            border-radius: var(--card-radius);
            text-align: center;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(46, 125, 50, 0.2);
        }

        .final-recommendation {
            font-size: 1.8rem;
            font-weight: 700;
            padding: 15px;
            margin-top: 20px;
            border-radius: var(--card-radius);
            text-align: center;
            border: 2px solid;
        }

        .recommend-strong-buy {
            background-color: rgba(56, 142, 60, 0.2);
            color: var(--success-color);
            border-color: var(--success-color);
        }
        .recommend-buy {
            background-color: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            border-color: #4CAF50;
        }
        .recommend-weak-buy {
            background-color: rgba(255, 193, 7, 0.2);
            color: var(--warning-color);
            border-color: var(--warning-color);
        }
        .recommend-not-recommended {
            background-color: rgba(244, 67, 54, 0.2);
            color: var(--error-color);
            border-color: var(--error-color);
        }
        .recommend-do-not-buy {
            background-color: rgba(211, 47, 47, 0.2);
            color: var(--error-color);
            border-color: var(--error-color);
        }


        /* Responsive Design */
        @media (max-width: 768px) {
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .input-section {
                flex-direction: column;
                gap: 20px;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .metrics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-chart-pie"></i> Stock Scoring Tool</h1>
            <p>Evaluate stock strength based on key fundamental and technical factors</p>
        </div>

        <div class="content">
            <div class="input-group">
                <label for="symbol">Stock Symbol <span class="tooltip"><i class="fas fa-info-circle"></i><span class="tooltiptext">Enter the stock ticker symbol (e.g., AMZ, META, MSFT)</span></span></label>
                <div class="input-wrapper">
                    <i class="fas fa-chart-line"></i>
                    <input type="text" id="symbol" placeholder="e.g., AMZ">
                </div>
            </div>

            <table class="scoring-table">
                <thead>
                    <tr>
                        <th>Step | Action</th>
                        <th>Good if...</th>
                        <th>Score</th>
                        <th>Where to find</th>
                        <th>What it means</th>
                        <th>Recommendation (Example)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1. Graph</td>
                        <td>1 year, 5 year - Growth</td>
                        <td>
                            <select id="score-graph" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Overview</td>
                        <td>N/A</td>
                        <td>STRONG BUY</td>
                    </tr>
                    <tr>
                        <td>2. Financial Indicators</td>
                        <td>Growth</td>
                        <td>
                            <select id="score-financial-indicators" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Overview</td>
                        <td>Revenue and...</td>
                        <td>Buy</td>
                    </tr>
                    <tr>
                        <td>3. PE & Forward PE</td>
                        <td>Less than 1, though around 1</td>
                        <td>
                            <select id="score-pe" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Overview+Sector</td>
                        <td>Price</td>
                        <td>Weak Buy</td>
                    </tr>
                    <tr>
                        <td>4. P/B</td>
                        <td>Less than 1, though around 1</td>
                        <td>
                            <select id="score-pb" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Financials->Ratios</td>
                        <td>Cost</td>
                        <td>Not Recommended</td>
                    </tr>
                    <tr>
                        <td>5. PEG</td>
                        <td>Less than 1, though around 1</td>
                        <td>
                            <select id="score-peg" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Financials->Ratios</td>
                        <td>How much</td>
                        <td>Do Not Buy</td>
                    </tr>
                    <tr>
                        <td>6. Debt / Equity Ratio</td>
                        <td>Less than 1, though around 1</td>
                        <td>
                            <select id="score-debt-equity" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Financials->Ratios</td>
                        <td>High P</td>
                        <td>STRONG NOT BUY</td>
                    </tr>
                    <tr>
                        <td>7. ROE</td>
                        <td>+13% and more, though 10%</td>
                        <td>
                            <select id="score-roe" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Financials->Ratios</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>8. Levered Free Cash Flow</td>
                        <td>Growth, though stability</td>
                        <td>
                            <select id="score-lfc-flow" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Financials->Cash Flow</td>
                        <td>How much</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>9. EPS Growth</td>
                        <td>+X%, though stability</td>
                        <td>
                            <select id="score-eps-growth" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Financials->Income</td>
                        <td>Growth</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>10. Shares Change (YoY)</td>
                        <td>-X%, though 0</td>
                        <td>
                            <select id="score-shares-change" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Financials->Income</td>
                        <td>How much</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>11. Dividend Growth</td>
                        <td>They are, growth</td>
                        <td>
                            <select id="score-dividend-growth" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Financials->Income</td>
                        <td>Money</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>12. Forecast</td>
                        <td>+X% in low forecast</td>
                        <td>
                            <select id="score-forecast" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Forecast</td>
                        <td>Forecasts and Sometimes</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>13. News</td>
                        <td>Positive, no lawsuits, etc.</td>
                        <td>
                            <select id="score-news" onchange="calculateScore()">
                                <option value="0">0 - Bad</option>
                                <option value="1">1 - Normal</option>
                                <option value="2">2 - Definitely Good</option>
                            </select>
                        </td>
                        <td>Overview</td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: right;"><b>9. Total Score:</b></td>
                        <td class="score-total" id="total-score">0</td>
                        <td colspan="3"></td>
                    </tr>
                </tbody>
            </table>

            <div class="final-recommendation" id="final-recommendation">
                <p>Select scores to get a recommendation.</p>
            </div>

            <div class="recommendation-widget">
                <h2><i class="fas fa-bullhorn"></i> Analyst Recommendations for <span id="widget-symbol-display">AAPL</span></h2>
                <div class="finnhub-widget-container">
                    <div id="widget-symbol" class="finnhub-widget" data-symbol="AAPL" data-theme="light" data-height="200"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_KEY = "d0kuab9r01qhb02558rgd0kuab9r01qhb02558s0"; // Finnhub API Key

        document.addEventListener('DOMContentLoaded', () => {
            // Initial calculation on page load
            calculateScore(); 
            // Update widget symbol when the input changes
            document.getElementById('symbol').addEventListener('input', updateFinnhubWidget);
            updateFinnhubWidget(); // Initial update for widget
        });

        function calculateScore() {
            let totalScore = 0;
            const scoreElements = [
                'score-graph', 'score-financial-indicators', 'score-pe', 'score-pb', 'score-peg',
                'score-debt-equity', 'score-roe', 'score-lfc-flow', 'score-eps-growth',
                'score-shares-change', 'score-dividend-growth', 'score-forecast', 'score-news'
            ];

            scoreElements.forEach(id => {
                const selectElement = document.getElementById(id);
                if (selectElement) {
                    totalScore += parseInt(selectElement.value);
                }
            });

            document.getElementById('total-score').textContent = totalScore;
            updateRecommendation(totalScore);
        }

        function updateRecommendation(score) {
            const recommendationDiv = document.getElementById('final-recommendation');
            let recommendationText = '';
            let className = '';

            if (score >= 38) { // Based on the image's 39 and 44 values for "Weak Buy" and general strong buy logic
                recommendationText = 'STRONG BUY';
                className = 'recommend-strong-buy';
            } else if (score >= 30) { 
                recommendationText = 'BUY';
                className = 'recommend-buy';
            } else if (score >= 20) { // Assuming thresholds, adjust as needed
                recommendationText = 'WEAK BUY';
                className = 'recommend-weak-buy';
            } else if (score >= 10) {
                recommendationText = 'NOT RECOMMENDED';
                className = 'recommend-not-recommended';
            } else {
                recommendationText = 'DO NOT BUY';
                className = 'recommend-do-not-buy';
            }

            recommendationDiv.innerHTML = `<p>${recommendationText}</p>`;
            recommendationDiv.className = `final-recommendation ${className}`;
        }

        function updateFinnhubWidget() {
            const symbol = document.getElementById('symbol').value.toUpperCase() || 'AAPL'; // Default to AAPL if empty
            const widgetDiv = document.getElementById('widget-symbol');
            const widgetSymbolDisplay = document.getElementById('widget-symbol-display');

            // Update the display text for the symbol
            widgetSymbolDisplay.textContent = symbol;

            // Clear existing widget content (if any)
            widgetDiv.innerHTML = ''; 
            
            // Create a new script element for the Finnhub widget
            const script = document.createElement('script');
            script.src = `https://widget.finnhub.io/widgets/recommendation.js?symbol=${symbol}&theme=light&height=200&token=${API_KEY}`;
            script.async = true;
            widgetDiv.appendChild(script);
        }
    </script>
    <script src="https://widget.finnhub.io/widgets/recommendation.js?symbol=AAPL&theme=light&height=200&token=d0kuab9r01qhb02558rgd0kuab9r01qhb02558s0" async></script>
</body>
</html>
